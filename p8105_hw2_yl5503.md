P8105 HW 2
================
Yuki Low yl5503

Loading necessary libraries

``` r
library(tidyverse)
library(haven)
library(readxl)
library(janitor)
library(dplyr)
library(tidyr)
library(stringr)
```

Question 1:

``` r
pols_df = 
  read_csv("./data/pols-month.csv") %>%
  janitor::clean_names()


pols_df <- pols_df %>% 
  separate(
    mon,
    into = c('year', 'month', 'day'), 
    sep = "-", 
    remove = TRUE) %>% 
  mutate(
    month = month.abb[as.numeric(month)], 
    president = case_when(prez_gop == 1 & prez_dem == 0 ~ "rep",
                          prez_dem == 1 & prez_gop == 0 ~ "dem")) %>%
    select(-prez_gop, -gov_gop, -day)
```

``` r
snp_df = 
  read_csv("./data/snp.csv") %>%
  janitor::clean_names()
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df <- snp_df %>% 
  separate(
    date, 
    into = c('month','day','year'),
    sep = '/',
    remove = TRUE) %>% 
  mutate(
    month = month.abb[as.numeric(month)]) %>%
  select(-day) %>% 
  select(year, month, close) %>% 
  mutate(year = str_c("19", year))
```

``` r
df <- left_join(pols_df,snp_df)
```

    ## Joining with `by = join_by(year, month)`

``` r
df <- df %>% 
  mutate(year = as.double(year))
```

Third, tidy the unemployment data so that it can be merged with the
previous datasets. This process will involve switching from “wide” to
“long” format; ensuring that key variables have the same name; and
ensuring that key variables take the same values.

``` r
unemploy_df = 
  read_csv("./data/unemployment.csv") %>%
  janitor::clean_names()
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemploy_df <- unemploy_df %>% 
  pivot_longer(cols = 2:13, names_to = "month", values_to = "unemployment") %>% 
  mutate(month = str_to_title(month))

head(unemploy_df)
```

    ## # A tibble: 6 × 3
    ##    year month unemployment
    ##   <dbl> <chr>        <dbl>
    ## 1  1948 Jan            3.4
    ## 2  1948 Feb            3.8
    ## 3  1948 Mar            4  
    ## 4  1948 Apr            3.9
    ## 5  1948 May            3.5
    ## 6  1948 Jun            3.6

``` r
final_df <- left_join(df, unemploy_df)
```

    ## Joining with `by = join_by(year, month)`

``` r
str(final_df)
```

    ## tibble [822 × 11] (S3: tbl_df/tbl/data.frame)
    ##  $ year        : num [1:822] 1947 1947 1947 1947 1947 ...
    ##  $ month       : chr [1:822] "Jan" "Feb" "Mar" "Apr" ...
    ##  $ sen_gop     : num [1:822] 51 51 51 51 51 51 51 51 51 51 ...
    ##  $ rep_gop     : num [1:822] 253 253 253 253 253 253 253 253 253 253 ...
    ##  $ prez_dem    : num [1:822] 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ gov_dem     : num [1:822] 23 23 23 23 23 23 23 23 23 23 ...
    ##  $ sen_dem     : num [1:822] 45 45 45 45 45 45 45 45 45 45 ...
    ##  $ rep_dem     : num [1:822] 198 198 198 198 198 198 198 198 198 198 ...
    ##  $ president   : chr [1:822] "dem" "dem" "dem" "dem" ...
    ##  $ close       : num [1:822] NA NA NA NA NA NA NA NA NA NA ...
    ##  $ unemployment: num [1:822] NA NA NA NA NA NA NA NA NA NA ...

The `pols-month.csv` dataset contains $9$ variables and $822$
observations. The `pols-month.csv` dataset tells us about the party
affiliation distribution (democrat or republican) for governors and
senators for a given year from years $1947$ to $2015$. It also tells us
whether the sitting president was a democrat or republican.

The `snp.csv` dataset contains $3$ variables and $787$ observations
ranging from years $1900$ to $1999$. The `snp.csv` dataset tells us the
closing value of the S&P stock index on the associated date. The three
variables are `month`, `day` and `close`. The average `close` value is
\$$474.8887404$.

``` r
mrtrashwheel_df = 
  read_excel("./data/202207 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel") %>%
  janitor::clean_names()
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
mrtrashwheel_df <-
  mrtrashwheel_df %>% 
  drop_na(dumpster) %>%
  select(dumpster:homes_powered) %>% 
  mutate(homes_powered = weight_tons * 500 / 30) %>% 
  mutate(name = "Mr Trash Wheel") %>% 
  mutate(year = as.numeric(year))

mrtrashwheel_df
```

    ## # A tibble: 547 × 15
    ##    dumpster month  year date                weight_tons volume…¹ plast…² polys…³
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>    <dbl>   <dbl>   <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31       18    1450    1820
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74       13    1120    1030
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45       15    2450    3100
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1        15    2380    2730
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06       18     980     870
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71       13    1430    2140
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91        8     910    1090
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7        16    3580    4310
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52       14    2400    2790
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76       18    1340    1730
    ## # … with 537 more rows, 7 more variables: cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, name <chr>, and abbreviated
    ## #   variable names ¹​volume_cubic_yards, ²​plastic_bottles, ³​polystyrene

``` r
proftrashwheel_df = 
  read_excel("./data/202207 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel") %>%
  janitor::clean_names()

proftrashwheel_df <- 
  proftrashwheel_df %>% 
  drop_na(dumpster) %>% 
  mutate(homes_powered = weight_tons * 500 / 30) %>% 
  mutate(name = "Professor Trash Wheel") %>% 
  mutate(year = as.numeric(year))

proftrashwheel_df
```

    ## # A tibble: 94 × 14
    ##    dumpster month     year date                weight_…¹ volum…² plast…³ polys…⁴
    ##       <dbl> <chr>    <dbl> <dttm>                  <dbl>   <dbl>   <dbl>   <dbl>
    ##  1        1 January   2017 2017-01-02 00:00:00      1.79      15    1950    6080
    ##  2        2 January   2017 2017-01-30 00:00:00      1.58      15    9540   11230
    ##  3        3 February  2017 2017-02-26 00:00:00      2.32      18    8350    9210
    ##  4        4 February  2017 2017-02-26 00:00:00      3.72      15    8590    1030
    ##  5        5 February  2017 2017-02-28 00:00:00      1.45      15    7830    9950
    ##  6        6 March     2017 2017-03-30 00:00:00      1.71      15    8210   10340
    ##  7        7 April     2017 2017-04-01 00:00:00      1.82      15    9830   11020
    ##  8        8 April     2017 2017-04-20 00:00:00      2.37      15    9240    8760
    ##  9        9 May       2017 2017-05-10 00:00:00      2.64      15    9540    8810
    ## 10       10 May       2017 2017-05-26 00:00:00      2.78      15    8230    7800
    ## # … with 84 more rows, 6 more variables: cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   homes_powered <dbl>, name <chr>, and abbreviated variable names
    ## #   ¹​weight_tons, ²​volume_cubic_yards, ³​plastic_bottles, ⁴​polystyrene

``` r
gwynnda_df = 
  read_excel("./data/202207 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel") %>%
  janitor::clean_names()

gwynnda_df <- 
  gwynnda_df %>% 
  mutate(grocery_bags = plastic_bags) %>% 
  select(!plastic_bags) %>% 
  mutate(name = "Gwynnda Trash Wheel")

gwynnda_df
```

    ## # A tibble: 108 × 12
    ##    dumpster month   year date                weight_tons volum…¹ plast…² polys…³
    ##       <dbl> <chr>  <dbl> <dttm>                    <dbl>   <dbl>   <dbl>   <dbl>
    ##  1        1 July    2021 2021-07-03 00:00:00        0.93      15    1200     360
    ##  2        2 July    2021 2021-07-07 00:00:00        2.26      15    2000     240
    ##  3        3 July    2021 2021-07-07 00:00:00        1.62      15    1800     270
    ##  4        4 July    2021 2021-07-16 00:00:00        1.76      15    1000     180
    ##  5        5 July    2021 2021-07-30 00:00:00        1.53      15    2100     240
    ##  6        6 August  2021 2021-08-11 00:00:00        2.06      15    2400     360
    ##  7        7 August  2021 2021-08-14 00:00:00        1.9       15    2700     320
    ##  8        8 August  2021 2021-08-16 00:00:00        2.16      15    3000     320
    ##  9        9 August  2021 2021-08-16 00:00:00        2.6       15     980     180
    ## 10       10 August  2021 2021-08-17 00:00:00        3.21      15     240      42
    ## # … with 98 more rows, 4 more variables: cigarette_butts <dbl>,
    ## #   homes_powered <dbl>, grocery_bags <dbl>, name <chr>, and abbreviated
    ## #   variable names ¹​volume_cubic_yards, ²​plastic_bottles, ³​polystyrene

``` r
mr_and_prof <- bind_rows(mrtrashwheel_df, proftrashwheel_df)
combined_df <- bind_rows(mr_and_prof, gwynnda_df)

combined_df
```

    ## # A tibble: 749 × 15
    ##    dumpster month  year date                weight_tons volume…¹ plast…² polys…³
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>    <dbl>   <dbl>   <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31       18    1450    1820
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74       13    1120    1030
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45       15    2450    3100
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1        15    2380    2730
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06       18     980     870
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71       13    1430    2140
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91        8     910    1090
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7        16    3580    4310
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52       14    2400    2790
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76       18    1340    1730
    ## # … with 739 more rows, 7 more variables: cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, name <chr>, and abbreviated
    ## #   variable names ¹​volume_cubic_yards, ²​plastic_bottles, ³​polystyrene

``` r
sum(filter(gwynnda_df,year == "2021" & month == "July")$cigarette_butts)
```

    ## [1] 16300

The number of observations in the resulting dataset after merging the
data from Mr. Trash Wheel, Professor Trash Wheel and Gwynnda Trash Wheel
was 749. The number of variables from the resulting dataset was 15. This
resulting dataset tells you the weight and volume of trash collected by
one of the three trash wheels (either Mr. Trash Wheel, Professor Trash
Wheel or Gwynnda Trash Wheel). It also tells us how much of each
material was found (e.g. plastic bottles, polysterene, cigarette butts,
etc.). The total weight of trash collected by Professor Trash Wheel was
190.12 tons. The total number of cigarette butts collected by Gwynnda in
July of 2021 was 1.63^{4}
